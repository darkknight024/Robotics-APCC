================================================================================
           AUTOMATIC TRAJECTORY CONVERSION - FEATURE SUMMARY
================================================================================

WHAT CHANGED
============

âœ… DEFAULT BEHAVIOR NOW: Auto-convert tool frame â†’ robot base frame
âœ… NEW FLAG: --relative (skip conversion for robot base frame CSVs)
âœ… REMOVED: --convert flag (conversion is now default)
âœ… SMART: Automatic detection and appropriate handling

BEHAVIOR
========

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PLAYBACK MODE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  NO FLAG (Default)                                                  â”‚
â”‚  â”œâ”€ Assumes: CSV in TOOL/LOCAL coordinates                         â”‚
â”‚  â”œâ”€ Action: Auto-convert to robot base frame                       â”‚
â”‚  â”œâ”€ Output: temp_converted/<filename>_base_frame.csv               â”‚
â”‚  â””â”€ Cleanup: temp_converted/ deleted after playback                â”‚
â”‚                                                                     â”‚
â”‚  --relative FLAG                                                    â”‚
â”‚  â”œâ”€ Assumes: CSV already in ROBOT BASE frame                       â”‚
â”‚  â”œâ”€ Action: Skip conversion, use directly                          â”‚
â”‚  â”œâ”€ Output: None (uses original CSV)                               â”‚
â”‚  â””â”€ Cleanup: Nothing to clean                                      â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USAGE COMMANDS
==============

# External/Tool-frame trajectory (MOST COMMON)
python Assests/irb_1300_example.py --mode p --csv external_path.csv

# Recorded/Base-frame trajectory
python Assests/irb_1300_example.py --mode p --csv recorded_path.csv --relative

# Recording (always saves in base frame)
python Assests/irb_1300_example.py --mode r

IMPLEMENTATION DETAILS
======================

File: Assests/irb_1300_example.py

Added Functions:
  - convert_trajectory_to_base_frame()
    â””â”€ Calls trajectory_transform.py subprocess
    â””â”€ Converts tool â†’ robot base coordinates
    â””â”€ Returns success/failure

Modified Functions:
  - main()
    â””â”€ Added conversion logic before playback
    â””â”€ Creates temp_converted/ directory
    â””â”€ Cleans up temp directory after playback

Added Arguments:
  - --relative (action="store_true")
    â””â”€ Skip conversion for robot base frame CSVs
    â””â”€ Default: False (always convert unless specified)

Validation:
  - Error if --relative used in record mode (warning only)
  - Auto-cleanup of temp files

CONVERSION PROCESS
==================

Step 1: Check mode and flags
  â”œâ”€ Playback mode + no --relative? â†’ Convert
  â””â”€ Playback mode + --relative? â†’ Direct

Step 2: Create temp directory (if converting)
  â”œâ”€ Location: Same directory as input CSV
  â”œâ”€ Name: temp_converted/
  â””â”€ File: <original_name>_base_frame.csv

Step 3: Call trajectory_transform.py
  â”œâ”€ Command: python trajectory_transform.py input.csv output.csv --meters
  â”œâ”€ Transform: Tool frame â†’ Robot base frame
  â””â”€ Units: Output in meters (Isaac Lab compatible)

Step 4: Use converted CSV for playback
  â””â”€ Pass to run_playback_mode()

Step 5: Cleanup temp directory
  â””â”€ Delete temp_converted/ after playback completes

COORDINATE SYSTEMS
==================

Tool/Local Frame:
  Origin: Tool center point (TCP) or local sensor
  Units: millimeters (input)
  Use case: External tools, CAD/CAM paths

Robot Base Frame:
  Origin: Robot base (Link_1)
  Units: meters (Isaac Lab)
  Use case: Recorded trajectories, robot control

Transform Parameters:
  Translation: [-367.773, -915.815, 520.4] mm
  Rotation: [0.00516, 0.71263, -0.70152, 0.00040] (quat w,x,y,z)

DECISION GUIDE
==============

Q: What CSV do I have?
â””â”€â”¬â”€ From external tool/CAD â†’ No flag (auto-convert)
  â”œâ”€ From this script's recording â†’ Use --relative
  â”œâ”€ Already converted â†’ Use --relative
  â””â”€ Unknown origin â†’ Try no flag first

Q: Is the trajectory wrong?
â””â”€â”¬â”€ Robot moves to wrong place â†’ Wrong frame assumption
  â”œâ”€ Too far/offset â†’ Need conversion (remove --relative)
  â””â”€ Correct location â†’ Already base frame (add --relative)

Q: How do I know which to use?
â””â”€â”¬â”€ See robot move in simulation
  â”œâ”€ Wrong: Toggle --relative flag
  â””â”€ Correct: Keep current setting

EXAMPLES
========

Example 1: External CAD Path
  Source: CAD software export (tool frame)
  Command: python Assests/irb_1300_example.py --mode p --csv cad_path.csv
  Result: Auto-converted, plays correctly

Example 2: Previously Recorded
  Source: Recording from this script (base frame)
  Command: python Assests/irb_1300_example.py --mode p --csv recorded.csv --relative
  Result: Plays directly, no conversion

Example 3: Unsure Origin
  1. Try default: python Assests/irb_1300_example.py --mode p --csv unknown.csv
  2. If wrong, try: python Assests/irb_1300_example.py --mode p --csv unknown.csv --relative
  3. Observe which one looks correct

ERROR HANDLING
==============

Error: "Conversion failed"
  Cause: trajectory_transform.py not found or failed
  Fix: Check scripts/utils/trajectory_transform.py exists

Error: Robot at wrong position
  Cause: Wrong coordinate frame assumption
  Fix: Toggle --relative flag

Error: Trajectory out of reach
  Cause: Wrong coordinate frame or invalid trajectory
  Fix: Check CSV format and coordinate frame

FILES & DIRECTORIES
===================

Created by Conversion:
  temp_converted/                    # Temporary, auto-deleted
  â””â”€ <filename>_base_frame.csv       # Converted trajectory

Created by Playback:
  speed_data/                        # Speed analysis results
  â”œâ”€ speed_*.npz                     # Raw speed data
  â”œâ”€ waypoint_speeds.png             # Speed per waypoint plot
  â”œâ”€ step_speeds.png                 # Speed per step plot
  â””â”€ combined_speed_analysis.png     # Combined analysis

  camera1_video_*.mp4                # Camera recordings
  camera2_video_*.mp4
  topdowncamera_video_*.mp4

BENEFITS
========

âœ… Easy to use: Just point to CSV, it auto-converts
âœ… Smart default: Most common use case is tool-frame
âœ… Flexible: --relative for base-frame CSVs
âœ… Clean: Auto-cleanup of temp files
âœ… Informative: Clear console output about what's happening
âœ… Error-safe: Validation and helpful error messages

WORKFLOW
========

1. Get trajectory CSV from external source
2. Run playback (default auto-converts):
   python Assests/irb_1300_example.py --mode p --csv my_trajectory.csv

3. Observe:
   - Console shows conversion process
   - temp_converted/ folder created
   - Trajectory plays in simulation

4. Review outputs:
   - Speed analysis in speed_data/
   - Camera videos
   - Converted CSV in temp_converted/ (before cleanup)

5. Script cleans up temp files automatically

SUMMARY
=======

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEFAULT = Auto-convert (tool â†’ robot base)                     â”‚
â”‚  --relative = Direct playback (already in robot base)           â”‚
â”‚                                                                 â”‚
â”‚  Most users will use DEFAULT (no flags)                        â”‚
â”‚  Only use --relative for recorded/converted trajectories       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DOCUMENTATION
=============

Created Files:
  - TRAJECTORY_CONVERSION_README.md    # Detailed guide
  - PLAYBACK_USAGE.txt                 # Quick reference
  - CONVERSION_FEATURE_SUMMARY.txt     # This file

Updated Files:
  - irb_1300_example.py                # Script docstring updated

================================================================================
                    READY TO USE! ğŸ¯
================================================================================

The default behavior makes external trajectories work out of the box!







